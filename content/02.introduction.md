# Introduction

Small molecules molecular mechancis (MM) force fields are essential to the design of small molecules for chemical 
biology and drug discovery, as well as the use of molecular simulation to understand the
behavior of biomolecular systems. However, small molecule force fields have lagged behind
protein force fields given the larger chemical space small molecule force fields need to 
cover [@doi:10.1021/acs.jctc.8b00821; @doi:10.1021/acs.jctc.5b00864]. Torsion parameters
are particularly problematic because they do not generalize very well [@doi:10.1186/s13321-019-0371-6].
It is possible to significantly improve the force field accuracy by refitting torsion 
parameters for individual molecules in a bespoke fashion [@doi:10.1002/jcc.23775; @doi:10.1002/jcc.23422; 
@doi:10.1021/ci500112w]. In many molecular mechanics force fields (e.g., Amber [@doi:10.1021/ja00124a002], 
CHARMM [@doi:10.1002/jcc.540040211], OPLS [@doi:10.1021/ja9621760]) a low-order Fourier series, such as
a cosine series, is often used to represent the contribution of torsion terms to the potential energy. 
The torsion potential energy parameters such as amplitudes and phase angles for each Fourier term, 
are generally fit to the residual difference between gas phase quantum chemistry (QC) torsion energy 
profile and the non-torsion MM parameters [@doi:10.1007/s00894-008-0305-0]. The QC torsion energy profile
is generated by fixing the torsion atoms and geometry minimizing all other atomic positions. 
Neighboring torsions can have correlated conformational preferences the low-order Fourier series does not capture[@doi:10.1038/s41598-018-21070-0]. 
2D spline fits, such as CMAP [@doi:10.1002/jcc.20082; @doi:10.26434/chemrxiv.8279681], have become a popular
way to model non-local correlations by fitting residuals between the 2D QC torsion energy profile and the 2D
MM torsion energy profile. 

Molecules are generally reduces to smaller model entities containing the torsion of interest for QC torsion scans [@doi:10.1021/acs.jctc.5b00864] for two main reasons as
illustrated in [hold for figure 1].

1. Generating one dimensional QC torsion profiles are computationally expensive and become increasingly inefficient
for larger molecules and/or higher dimensional QC torsion profiles. QC calculations scale badly with the number
of heavy atoms $N$, like $O(N^M)$ where $M\leq 4$ for hybrid DFT functionals which is generally used in QC torison scans. To adequately fit the torsions,
constrained geometry optimizations need to be calculated at $\leq 15^0$ intervals for a minimum of 24 constrained 
geometry optimizations. To avoid hysteresis in the energy profile due to orthogonal degrees of freedom [@doi:10.1021/acs.jpcb.7b02320],
methods like wavefront propagation [hold for CITE torsiondrive paper] are used. This adds a factor of 2D, where D is the dimension of the QC scan,
to the computational cost. [hold for figure 1A] illustrates the average CPU time of a torsion scan for an average drug-like molecules. The shaded
histogram is the distribution of the number of heavy atoms in FDA approved small molecules taken from DrugBank [@doi:10.1093/nar/gkx1037]. 
The average molecules size is [N] heavy atom which corresponds to an average of [t] CPU seconds per energy and gradient evaluation at B3LYP-D3(BJ)/DZVP 
[@doi:10.1063/1.3382344; @doi:10.1139/v92-079]. An average constrained geometry optimization takes 20 energy and gradient evaluations to converge.
The average cost for a 1D QC torsion scan is t*24*20*2 = s. 

2. In larger molecules, there is a greater potential for the torsion atoms to interact with other degrees of freedom and 
convolute the energy profile. While this can also happen in smaller molecules such as ethylene glycol 
this problem is reduced when a minimal model molecule is used as illustrated in [hold for figure 1B].

Many fragmentation algorithms exist, but they are not appropriate for torsion scans in particular and are insufficiently 
automated. These algorithms fall into two categories: 1. fragmentation for synthetic accessibility [@doi:10.1021/ci970429i;
@doi:10.1021/acs.jcim.6b00596; @doi:10.1021/jm9602928] and 2. fragmenting molecules to achieve linear scaling for QC calculations
[@doi:10.1002/jcc.25149; @doi:10.1063/1.1879792; @doi:10.1021/cr200093j; @doi:10.1039/c2cp23832b]. 
Fragmentation schemes for synthetic accessibility find building blocks for combinatorial and fragment based drug design. 
Cleavage happens at points where it makes sense for chemical reactions and do not consider how those cuts affect the 
electronic properties of the fragments. For retrosynthetic applications, many cleavage points are at functional groups because 
those are the reactive sites of molecules. However, for our application, we especially do not want to fragment at these
reactive points given how electron rich they are and how much the electronic density changes when they are altered. 
Fragmentation algorithms for linear scaling such as Divide-and-Conquer methods [@doi:10.1063/1.472136], effective fragment potential method
[@doi:10.1002/jcc.10309] and systematic molecular fragmentation methods [@doi:10.1039/c2cp23832b] require the users to manually 
specify where the cuts should be or which bonds not to fragment. Furthermore, none of these methods address the needs specific
to fragmenting molecules for QC torsion scans. Fragments need to include all atoms involved in 1-4 interactions, since they 
are incorporated in the fitting procedure. We also need a systematic way to determine if remote substituents change
the barrier to rotation significantly for the central bond of interest.

In this work, we use the Wiberg Bond Order (WBO) [@doi:10/fvwkkh], which is both simple to calculate
from semi-empirical QC methods and is sensitive to the chemical environment around a bond. WBOs quantify electron population
overlap between bonds, or the degree of binding between atoms. WBOs are correlated with bond
vibrational frequencies [@doi:10.1021/jp4010345, @doi:10.1351/pac198961040635] and is used to predict trigger bonds in high energy-density material
because it is correlated with the strength of the bond [@doi:10.1002/cphc.201500773]. Wei, et. al. [@doi:10.1021/acs.jcim.9b00585] have shown
that simple rules for electron richness of aromatic systems in biaryls are good indication of torsion force constants (specifically for V~2~), however, this
measure was only developed for biaryls and it does not take into account substituents beyond the aromatic ring directly adjacent to the bond.
Here, we develop an approach that uses the WBO to validate whether a fragmentation scheme corrupts the local chemical environment of interest,
with a particular focus on fragmentation schemes suitable for QC torsion drives. Our approach uses simple 
heuristics to arrive at a minimal fragment for QM torsion scan that is representative of of the torsion scan of the 
substructure in the parent molecules. For a central bond, include all atoms that are involved in the sterics 
of a torsion scan. Then use the WBO as a surrogate signal to determine if the fragment needs to be
grown out more to restore the correct electronics around the central bonds. 

The paper is organizes as follows:
Section 2 provides a mathematical and physical definition of the problem.
Section 3 provides the motivation for using the WBO as a surrogate, evaluates how robust it is, proposes a minimal 
fragmentation scheme and describes a rich validation set that can be used to benchmark fragmentation schemes
Section 4 provides a discussion of the implications of this study and section 5 provides detailed methods. 
